# å…°å¿ƒè¿è¥ç¬”è®° - æ”¯ä»˜ç³»ç»Ÿè®¾ç½®æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

æˆ‘å·²ç»ä¸ºæ‚¨çš„ç½‘ç«™é›†æˆäº†ç°ä»£åŒ–çš„æ”¯ä»˜è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒä»¥ä¸‹æ”¯ä»˜æ–¹å¼ï¼š

### æ”¯ä»˜æ–¹å¼
1. **ğŸ’³ Stripeä¿¡ç”¨å¡æ”¯ä»˜** - æ”¯æŒå…¨çƒä¿¡ç”¨å¡/å€Ÿè®°å¡
2. **ğŸŒ PayPalæ”¯ä»˜** - å…¨çƒé€šç”¨åœ¨çº¿æ”¯ä»˜
3. **ğŸ“± å¾®ä¿¡æ”¯ä»˜** - ä¸­å›½ç”¨æˆ·æ‰«ç æ”¯ä»˜
4. **ğŸ“± æ”¯ä»˜å®** - ä¸­å›½ç”¨æˆ·æ‰«ç æ”¯ä»˜

## ğŸ“¦ å®‰è£…ä¾èµ–

```bash
# å®‰è£…Node.jsä¾èµ–
npm install

# æˆ–ä½¿ç”¨yarn
yarn install
```

## ğŸ”§ é…ç½®æ­¥éª¤

### 1. Stripeé…ç½®

1. æ³¨å†Œ [Stripeè´¦æˆ·](https://stripe.com)
2. è·å–APIå¯†é’¥ï¼š
   - æµ‹è¯•ç¯å¢ƒï¼š`pk_test_...` å’Œ `sk_test_...`
   - ç”Ÿäº§ç¯å¢ƒï¼š`pk_live_...` å’Œ `sk_live_...`

3. åœ¨ `payment-server.js` ä¸­æ›¿æ¢ï¼š
```javascript
const stripe = require('stripe')('sk_test_YOUR_STRIPE_SECRET_KEY');
```

4. åœ¨ `payment.html` ä¸­æ›¿æ¢ï¼š
```javascript
const stripe = Stripe('pk_test_YOUR_STRIPE_PUBLISHABLE_KEY');
```

### 2. PayPalé…ç½®

1. æ³¨å†Œ [PayPal Developerè´¦æˆ·](https://developer.paypal.com)
2. åˆ›å»ºåº”ç”¨è·å–Client ID
3. åœ¨ `payment.html` ä¸­æ›¿æ¢ï¼š
```html
<script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_CLIENT_ID&currency=CNY"></script>
```

### 3. å¾®ä¿¡æ”¯ä»˜å’Œæ”¯ä»˜å®

- å½“å‰ä½¿ç”¨é™æ€äºŒç»´ç å›¾ç‰‡
- å¦‚éœ€åŠ¨æ€äºŒç»´ç ï¼Œéœ€è¦ï¼š
  - å¾®ä¿¡æ”¯ä»˜ï¼šç”³è¯·å¾®ä¿¡å•†æˆ·å·
  - æ”¯ä»˜å®ï¼šç”³è¯·æ”¯ä»˜å®å•†æˆ·å·

## ğŸš€ å¯åŠ¨æœåŠ¡å™¨

### é™æ€æ–‡ä»¶æœåŠ¡å™¨ï¼ˆå½“å‰ï¼‰
```bash
node server.js
# è®¿é—®: http://localhost:8000
```

### æ”¯ä»˜å¤„ç†æœåŠ¡å™¨ï¼ˆæ–°å¢ï¼‰
```bash
node payment-server.js
# è®¿é—®: http://localhost:3000
```

### åŒæ—¶è¿è¡Œä¸¤ä¸ªæœåŠ¡å™¨
```bash
# ç»ˆç«¯1 - é™æ€æ–‡ä»¶æœåŠ¡å™¨
node server.js

# ç»ˆç«¯2 - æ”¯ä»˜å¤„ç†æœåŠ¡å™¨
node payment-server.js
```

## ğŸ“ æ–‡ä»¶ç»“æ„

```
lxyybj3/
â”œâ”€â”€ payment.html              # å¢å¼ºç‰ˆæ”¯ä»˜é¡µé¢
â”œâ”€â”€ payment-server.js         # æ”¯ä»˜å¤„ç†åç«¯
â”œâ”€â”€ package.json             # Node.jsä¾èµ–é…ç½®
â”œâ”€â”€ server.js               # é™æ€æ–‡ä»¶æœåŠ¡å™¨
â””â”€â”€ images/
    â”œâ”€â”€ n1. wechat-pay.png   # å¾®ä¿¡æ”¯ä»˜å›¾æ ‡
    â”œâ”€â”€ n2. alipay.png       # æ”¯ä»˜å®å›¾æ ‡
    â”œâ”€â”€ n3. wechat-qr.png    # å¾®ä¿¡æ”¯ä»˜äºŒç»´ç 
    â””â”€â”€ n4. alipay-qr.png    # æ”¯ä»˜å®äºŒç»´ç 
```

## ğŸ” å®‰å…¨é…ç½®

### Webhookè®¾ç½®ï¼ˆé‡è¦ï¼‰

1. **Stripe Webhook**ï¼š
   - åœ¨Stripeæ§åˆ¶å°è®¾ç½®webhook URL: `https://yourdomain.com/webhook`
   - é€‰æ‹©äº‹ä»¶ï¼š`payment_intent.succeeded`, `payment_intent.payment_failed`

2. **PayPal Webhook**ï¼š
   - åœ¨PayPalå¼€å‘è€…æ§åˆ¶å°è®¾ç½®webhook

## ğŸ’° ä¼šå‘˜è®¡åˆ’é…ç½®

å½“å‰æ”¯æŒçš„ä¼šå‘˜è®¡åˆ’ï¼š

```javascript
const plans = {
    basic: {
        name: 'åŸºç¡€ä¼šå‘˜',
        price: 9900,      // Â¥99.00 (ä»¥åˆ†ä¸ºå•ä½)
        currency: 'cny',
        interval: 'month'
    },
    pro: {
        name: 'ä¸“ä¸šä¼šå‘˜',
        price: 29900,     // Â¥299.00
        currency: 'cny',
        interval: 'month'
    },
    enterprise: {
        name: 'ä¼ä¸šä¼šå‘˜',
        price: 99900,     // Â¥999.00
        currency: 'cny',
        interval: 'year'
    }
};
```

## ğŸŒ éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

### 1. ç¯å¢ƒå˜é‡
åˆ›å»º `.env` æ–‡ä»¶ï¼š
```env
STRIPE_PUBLISHABLE_KEY=pk_live_...
STRIPE_SECRET_KEY=sk_live_...
STRIPE_WEBHOOK_SECRET=whsec_...
PAYPAL_CLIENT_ID=your_live_client_id
PORT=3000
NODE_ENV=production
```

### 2. SSLè¯ä¹¦
- ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨HTTPS
- æ¨èä½¿ç”¨Let's Encryptå…è´¹SSLè¯ä¹¦

### 3. åŸŸåé…ç½®
- æ›´æ–°Stripeå’ŒPayPalçš„åŸŸåç™½åå•
- é…ç½®webhook URLä¸ºç”Ÿäº§åŸŸå

## ğŸ“Š æµ‹è¯•

### Stripeæµ‹è¯•å¡å·
```
æˆåŠŸæ”¯ä»˜: 4242 4242 4242 4242
å¤±è´¥æ”¯ä»˜: 4000 0000 0000 0002
éœ€è¦éªŒè¯: 4000 0025 0000 3155
```

### PayPalæµ‹è¯•
- ä½¿ç”¨PayPalæ²™ç›’ç¯å¢ƒ
- åˆ›å»ºæµ‹è¯•ä¹°å®¶å’Œå–å®¶è´¦æˆ·

## ğŸ”„ ä¸‹ä¸€æ­¥ä¼˜åŒ–

1. **æ•°æ®åº“é›†æˆ**ï¼šå­˜å‚¨ç”¨æˆ·è®¢é˜…ä¿¡æ¯
2. **é‚®ä»¶é€šçŸ¥**ï¼šæ”¯ä»˜æˆåŠŸ/å¤±è´¥é€šçŸ¥
3. **ç”¨æˆ·dashboard**ï¼šæŸ¥çœ‹è®¢é˜…çŠ¶æ€
4. **é€€æ¬¾å¤„ç†**ï¼šè‡ªåŠ¨åŒ–é€€æ¬¾æµç¨‹
5. **åˆ†æç»Ÿè®¡**ï¼šæ”¯ä»˜æ•°æ®åˆ†æ

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœæ‚¨åœ¨è®¾ç½®è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤webhook URLå¯è®¿é—®
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
4. æ£€æŸ¥æœåŠ¡å™¨æ—¥å¿—

## ğŸ¯ æµ‹è¯•æ”¯ä»˜æµç¨‹

1. è®¿é—® `http://localhost:8000/payment.html`
2. é€‰æ‹©ä¼šå‘˜è®¡åˆ’
3. é€‰æ‹©æ”¯ä»˜æ–¹å¼è¿›è¡Œæµ‹è¯•ï¼š
   - **ä¿¡ç”¨å¡**ï¼šä½¿ç”¨æµ‹è¯•å¡å·
   - **PayPal**ï¼šä½¿ç”¨æ²™ç›’è´¦æˆ·
   - **æ‰«ç æ”¯ä»˜**ï¼šå½“å‰ä¸ºæ¼”ç¤ºæ¨¡å¼

æ”¯ä»˜ç³»ç»Ÿå·²ç»å‡†å¤‡å°±ç»ªï¼ğŸ‰ 